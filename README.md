# å°ç¨‹åº/å°æ¸¸æˆ/å¿«åº”ç”¨ SDK ä½¿ç”¨æŒ‡å—

**GravityAnalytics MP Library** æ˜¯ä¸ºå°ç¨‹åºã€å°æ¸¸æˆã€å¿«åº”ç”¨ç­‰å¹³å°å®žçŽ°çš„ä»£ç åŸ‹ç‚¹+ä¹°é‡å½’å› çš„å·¥å…· SDKï¼Œæˆ‘ä»¬é€šè¿‡æ‰“åŒ…æ—¶å¯¹éƒ¨åˆ†ä»£ç çš„æ›¿æ¢ï¼Œå®žçŽ°å¤šä¸ªå¹³å°çš„é€‚é…ï¼Œç›®å‰ SDK çš„å…¼å®¹æ€§å¦‚ä¸‹ï¼š

æ”¯æŒå¹³å°

- å¾®ä¿¡å°ç¨‹åº
- å¾®ä¿¡å°æ¸¸æˆ
- å¿«åº”ç”¨

æ”¯æŒåª’ä½“

- å¤´æ¡å·¨é‡å¼•æ“Ž
- å¿«æ‰‹ç£åŠ›å¼•æ“Ž
- è…¾è®¯å¹¿å‘Š
- ç™¾åº¦è¥é”€

æ”¯æŒæ¸¸æˆå¼•æ“Ž

- [CocosCreator](https://www.cocos.com/)
- [Egret ç™½é¹­å¼•æ“Ž](https://www.egret.com/)
- [Laya](https://layaair.layabox.com/#/)

> æ›´å¤šå¹³å°æ­£åœ¨æ”¯æŒä¸­ï¼Œè¯¦ç»†çš„ä½¿ç”¨è¯´æ˜Žï¼Œè¯·å‚è€ƒæˆ‘ä»¬çš„[å®˜æ–¹ä½¿ç”¨æ‰‹å†Œ](https://doc.gravity-engine.com/)ã€‚

## ä¸€ã€é›†æˆä¸Žåˆå§‹åŒ–

å¼€å§‹æŽ¥å…¥å·¥ä½œä¹‹å‰ï¼Œæ‚¨éœ€è¦å…ˆ[ä¸‹è½½ SDK](https://github.com/GravityInfinite/mpg-demos/releases)ï¼Œç„¶åŽå†æ ¹æ®æ‚¨çš„æŠ€æœ¯æ ˆé€‰æ‹©ä¸åŒçš„æŽ¥å…¥æ–¹å¼ã€‚

### 1.1 å¾®ä¿¡å°æ¸¸æˆåŽŸç”Ÿé›†æˆ

ä¸‹è½½ `gravityengine.mg.wx.min.js`ï¼Œæ”¾å…¥ä¸Ž `app.js` ç›¸åŒçš„ç›®å½•ä¸­ï¼Œåœ¨ `app.js` ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç åˆå§‹åŒ– SDK:

```js
var GE = require("./gravityengine.mg.wx.min.js");
var config = {
  accessToken: "gZGljPsq7I4wc3BMvkAUsevQznx1jahi",
  clientId: "your_client_id", // é¡¹ç›®çš„ APP ID
  autoTrack: {
    appLaunch: true, // è‡ªåŠ¨é‡‡é›† $MPLaunch
    appShow: true, // è‡ªåŠ¨é‡‡é›† $MPShow
    appHide: true, // è‡ªåŠ¨é‡‡é›† $MPHide
  },
  name: "ge", // å…¨å±€å˜é‡åç§°, é»˜è®¤ä¸º gravityengine
};
new GE(config);
ge.init();
```

### 1.2 å¾®ä¿¡å°ç¨‹åºåŽŸç”Ÿé›†æˆ

å°† `gravityengine.wx.min.js` å¯¼å…¥å·¥ç¨‹ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹ä»£ç åˆå§‹åŒ– SDKï¼š

```js
var GE = require("./utils/gravityengine.wx.min.js");
var config = {
  accessToken: "gZGljPsq7I4wc3BMvkAUsevQznx1jahi",
  clientId: "your_client_id", // é¡¹ç›®çš„ APP ID
  autoTrack: {
    appLaunch: true, // è‡ªåŠ¨é‡‡é›† $MPLaunch
    appShow: true, // è‡ªåŠ¨é‡‡é›† $MPShow
    appHide: true, // è‡ªåŠ¨é‡‡é›† $MPHide
    pageShow: true, // è‡ªåŠ¨é‡‡é›† $MPViewScreen
    pageShare: true, // è‡ªåŠ¨é‡‡é›† $MPShare
  },
  name: "ge", // å…¨å±€å˜é‡åç§°, é»˜è®¤ä¸º gravityengine
};
// var app = getApp();
// app.ge = new GE(config);
var ge = new GE(config);
ge.init();
```

### 1.3 CocosCreator é›†æˆ

#### 1.3.1 å¯¼å…¥ SDKï¼š

TypeScript é¡¹ç›®ï¼š

- å°†å£°æ˜Žæ–‡ä»¶ `GravityAnalyticsSDK.d.ts` æ”¾å…¥é¡¹ç›®æ ¹ç›®å½•ä¸‹ `assets` ä¸‹çº§çš„ `libs` ç›®å½•ï¼Œå¦‚æžœ `libs` ä¸å­˜åœ¨ï¼Œæ–°å»º `libs` ç›®å½•
- å°† SDK æ–‡ä»¶ `gravityengine.mg.cocoscreator.min.js` æ”¾å…¥ `assets/Script` ç›®å½•ä¸­

JavaScript é¡¹ç›®ï¼š

- å°† SDK æ–‡ä»¶ `gravityengine.mg.cocoscreator.min.js` æ”¾å…¥ `assets/Script` ç›®å½•ä¸­

#### 1.3.2 é…ç½®åˆå§‹åŒ–å‚æ•°

```javascript
const config = {
  accessToken: "gZGljPsq7I4wc3BMvkAUsevQznx1jahi", // é¡¹ç›®é€šè¡Œè¯ï¼Œåœ¨ï¼šç½‘ç«™åŽå°-->ç®¡ç†ä¸­å¿ƒ-->åº”ç”¨åˆ—è¡¨ä¸­æ‰¾åˆ°Access Tokenåˆ— å¤åˆ¶ï¼ˆé¦–æ¬¡ä½¿ç”¨å¯èƒ½éœ€è¦å…ˆæ–°å¢žåº”ç”¨ï¼‰
  clientId: "your_client_id", // ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼Œå¦‚å¾®ä¿¡å°ç¨‹åºçš„openid
  autoTrack: {
    appLaunch: true, // è‡ªåŠ¨é‡‡é›† $MPLaunch
    appShow: true, // è‡ªåŠ¨é‡‡é›† $MPShow
    appHide: true, // è‡ªåŠ¨é‡‡é›† $MPHide
  },
  name: "ge", // å…¨å±€å˜é‡åç§°
  enableLog: false, // æ˜¯å¦å¼€å¯æ—¥å¿—æ‰“å°
  enablePersistence: true, // æ˜¯å¦ç¼“å­˜
};
const ge = new GravityAnalyticsAPI(config);
ge.init();
```

### 1.4 Laya é›†æˆ

#### 1.4.1 å¯¼å…¥ SDK

TypeScript é¡¹ç›®ï¼š

- å°†å£°æ˜Žæ–‡ä»¶ `GravityAnalyticsSDK.d.ts` æ”¾å…¥ `libs`ç›®å½•ï¼›
- å°† SDK æ–‡ä»¶ `gravityengine.mg.layats.min.js` æ”¾å…¥ bin/js ç›®å½•ä¸­
- ä¿®æ”¹ `bin/index.js` æ–‡ä»¶ï¼ŒåŠ è½½ SDKï¼š

```javascript
// sdkå¿…é¡»åœ¨bundle.jsä¹‹å‰åŠ è½½
loadLib("js/gravityengine.mg.layats.min.js");
loadLib("js/bundle.js");
```

JavaScript é¡¹ç›®ï¼š

- å°† `gravityengine.mg.laya.min.js` å¯¼å…¥å·¥ç¨‹ï¼š
  ```javascript
  import GravityAnalyticsAPI from "gravityengine.mg.laya.min.js";
  ```

#### 1.4.2 é…ç½®åˆå§‹åŒ–å‚æ•°

å¼•å…¥ SDK åŽï¼Œå³å¯è¿›è¡Œ SDK åˆå§‹åŒ–å‚æ•°é…ç½®ï¼š

```javascript
const config = {
  accessToken: "gZGljPsq7I4wc3BMvkAUsevQznx1jahi", // é¡¹ç›®é€šè¡Œè¯ï¼Œåœ¨ï¼šç½‘ç«™åŽå°-->ç®¡ç†ä¸­å¿ƒ-->åº”ç”¨åˆ—è¡¨ä¸­æ‰¾åˆ°Access Tokenåˆ— å¤åˆ¶ï¼ˆé¦–æ¬¡ä½¿ç”¨å¯èƒ½éœ€è¦å…ˆæ–°å¢žåº”ç”¨ï¼‰
  clientId: "your_client_id", // ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼Œå¦‚å¾®ä¿¡å°ç¨‹åºçš„openid
  autoTrack: {
    appLaunch: true, // è‡ªåŠ¨é‡‡é›† $MPLaunch
    appShow: true, // è‡ªåŠ¨é‡‡é›† $MPShow
    appHide: true, // è‡ªåŠ¨é‡‡é›† $MPHide
    pageShow: true, // è‡ªåŠ¨é‡‡é›† $MPViewScreen
    pageShare: true, // è‡ªåŠ¨é‡‡é›† $MPShare
  },
  name: "ge", // å…¨å±€å˜é‡åç§°
  enableLog: false, // æ˜¯å¦å¼€å¯æ—¥å¿—æ‰“å°
  enablePersistence: true, // æ˜¯å¦ç¼“å­˜
};
const ge = new GravityAnalyticsAPI(config);
ge.init();
```

### 1.5 Egret é›†æˆ

#### 1.5.1 å¯¼å…¥ SDK

`GravityAnalyticsSDK` ç›®å½•æ”¾å…¥æ‚¨é¡¹ç›®çš„ `libs` ç›®å½•ä¸‹ã€‚ç„¶åŽåœ¨æ‚¨é¡¹ç›®çš„é…ç½®æ–‡ä»¶ `egretProperties.json` ä¸­å¼•å…¥ SDK:

```json
{
  "name": "GravityAnalyticsSDK",
  "path": "./libs/GravityAnalyticsSDK"
}
```

#### 1.5.2 é…ç½®åˆå§‹åŒ–å‚æ•°

é›†æˆ SDK åŽï¼Œæ‚¨å¯ä»¥åœ¨ä»£ç ä¸­ç›´æŽ¥ä½¿ç”¨ `GravityAnalyticsAPI`:

```javascript
const config = {
  accessToken: "gZGljPsq7I4wc3BMvkAUsevQznx1jahi", // é¡¹ç›®é€šè¡Œè¯ï¼Œåœ¨ï¼šç½‘ç«™åŽå°-->ç®¡ç†ä¸­å¿ƒ-->åº”ç”¨åˆ—è¡¨ä¸­æ‰¾åˆ°Access Tokenåˆ— å¤åˆ¶ï¼ˆé¦–æ¬¡ä½¿ç”¨å¯èƒ½éœ€è¦å…ˆæ–°å¢žåº”ç”¨ï¼‰
  clientId: "your_client_id", // ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼Œå¦‚å¾®ä¿¡å°ç¨‹åºçš„openid
  autoTrack: {
    appLaunch: true, // è‡ªåŠ¨é‡‡é›† $MPLaunch
    appShow: true, // è‡ªåŠ¨é‡‡é›† $MPShow
    appHide: true, // è‡ªåŠ¨é‡‡é›† $MPHide
  },
  name: "ge", // å…¨å±€å˜é‡åç§°ï¼Œå¯ä½¿ç”¨getApp().geèŽ·å–ge
  enableLog: false, // æ˜¯å¦å¼€å¯æ—¥å¿—æ‰“å°
  enablePersistence: true, // æ˜¯å¦ç¼“å­˜
};
const ge = new GravityEngine(config);
ge.init();
```

### 1.6 å¿«åº”ç”¨é›†æˆ

#### 1.6.1 å¯¼å…¥ SDK

- å°† `gravityengine.quick.js` æ–‡ä»¶å¯¼å…¥å¿«åº”ç”¨é¡¹ç›®ä¸­ï¼›
- åœ¨ `app.ux` æ–‡ä»¶ä¸­å¼•å…¥ SDKï¼š

```javascript
import ge from "./helper/gravityengine.quick";
```

#### 1.6.2 é…ç½®åˆå§‹åŒ–å‚æ•°

å¼•å…¥ SDK åŽï¼Œå³å¯è¿›è¡Œ SDK åˆå§‹åŒ–å‚æ•°é…ç½®ï¼š

```javascript
const config = {
  accessToken: "gZGljPsq7I4wc3BMvkAUsevQznx1jahi", // é¡¹ç›®é€šè¡Œè¯ï¼Œåœ¨ï¼šç½‘ç«™åŽå°-->ç®¡ç†ä¸­å¿ƒ-->åº”ç”¨åˆ—è¡¨ä¸­æ‰¾åˆ°Access Tokenåˆ— å¤åˆ¶ï¼ˆé¦–æ¬¡ä½¿ç”¨å¯èƒ½éœ€è¦å…ˆæ–°å¢žåº”ç”¨ï¼‰
  clientId: "your_client_id", // ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼Œå¦‚å¾®ä¿¡å°ç¨‹åºçš„openid
  name: "ge", // å…¨å±€å˜é‡åç§°ï¼Œå¯ä½¿ç”¨getApp().geèŽ·å–ge
  enableLog: false, // æ˜¯å¦å¼€å¯æ—¥å¿—æ‰“å°
  enablePersistence: true, // æ˜¯å¦ç¼“å­˜
};
const ge = new GravityEngine(config);
ge.init();
```

> å…¶ä»–å¯èƒ½ä¼šç”¨åˆ°çš„é…ç½®æœ‰ï¼š

```javascript
enableLog: true, // æ˜¯å¦æ‰“å¼€æ—¥å¿—æ‰“å°
sendTimeout: 3000, // ç½‘ç»œè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤å€¼ 3000 ms
maxRetries: 3, // ç½‘ç»œè¯·æ±‚å¤±è´¥æ—¶çš„é‡è¯•æ¬¡æ•°ï¼Œ1 è¡¨ç¤ºä¸é‡è¯•ã€‚é»˜è®¤å€¼æ˜¯ 3
enablePersistence: true, // æ˜¯å¦ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œä¸»å®žä¾‹é»˜è®¤ä¸º trueï¼Œå­å®žä¾‹é»˜è®¤ä¸º false
asyncPersistence: false, // æ˜¯å¦ä½¿ç”¨å¼‚æ­¥å­˜å‚¨ï¼Œé»˜è®¤ä¸º false
```

### 1.7 é…ç½®é¡¹ç›®åˆæ³•åŸŸå

å°† https://turbo.api.plutus-cat.com é…ç½®åˆ°å¾®ä¿¡åŽå° request åˆæ³•åŸŸååˆ—è¡¨ä¸­ã€‚

## äºŒã€é…ç½® SDK

### 2.1 ç”¨æˆ·æ³¨å†Œ

åœ¨ç”¨æˆ·æ³¨å†Œæˆ–è€…å¯ä»¥èŽ·å–åˆ°ç”¨æˆ·å”¯ä¸€æ€§ä¿¡æ¯æ—¶è°ƒç”¨æ­¤æ–¹æ³•ï¼ŒæŽ¨èé¦–æ¬¡å®‰è£…å¯åŠ¨æ—¶è°ƒç”¨ï¼ŒåŽç»­å…¶ä»–æŽ¥å£ï¼Œå‡éœ€è¦ç­‰ `register` æŽ¥å£å®Œæˆä¹‹åŽæ‰èƒ½ç»§ç»­è°ƒç”¨ã€‚

```javascript
/**
 * @param {string} name         ç”¨æˆ·åï¼ˆå¿…å¡«ï¼‰
 * @param {string} channel      ç”¨æˆ·æ³¨å†Œæ¸ é“ï¼ˆå¿…å¡«ï¼‰
 * @param {number} version      ç”¨æˆ·æ³¨å†Œçš„ç¨‹åºç‰ˆæœ¬ï¼ˆå¿…å¡«ï¼‰
 * @param {string} click_id     ç”¨æˆ·ç‚¹å‡»å¹¿å‘Šid å¾®ä¿¡å°ç¨‹åºé€‰å¡«
 * @param {string} wx_openid    å¾®ä¿¡open id (å¾®ä¿¡å°ç¨‹åºå¿…å¡«)
 * @param {string} wx_unionid   å¾®ä¿¡union idï¼ˆå¾®ä¿¡å°ç¨‹åºé€‰å¡«ï¼‰
 */

ge.register({
  name: "your_name",
  channel: "your_channel",
  version: 123,
  click_id: "your_click_id",
  wx_openid: "your_wx_openid",
  wx_unionid: "your_wx_unionid",
});
```

> ðŸ“¢ æ³¨æ„ï¼šæ­¤æ–¹æ³•ä¸ºå¿…é¡»è°ƒç”¨çš„ï¼Œä¸ç„¶æ— æ³•å®Œæˆå…¶ä»–æ–¹æ³•çš„æ­£å¸¸è°ƒç”¨ï¼

### 2.2 å…¬å…±å±žæ€§

> å…¬å…±äº‹ä»¶å±žæ€§æ˜¯æ‰€æœ‰äº‹ä»¶ï¼ˆåŒ…æ‹¬è‡ªåŠ¨é‡‡é›†äº‹ä»¶ï¼‰éƒ½ä¼šåŒ…å«çš„å±žæ€§ï¼Œç”¨æˆ·å±žæ€§ä¸­ä¸ä¼šåŒ…å«ã€‚
>
> æœ¬èŠ‚ä¼šä»‹ç»å¦‚ä½•è®¾ç½®å…¬å…±äº‹ä»¶å±žæ€§å’ŒåŠ¨æ€å…¬å…±å±žæ€§ã€‚å¦‚æžœå…¬å…±å±žæ€§ä¸Žäº‹ä»¶ä¸­è®¾ç½®çš„è‡ªå®šä¹‰å±žæ€§æœ‰ç›¸åŒ key å€¼ï¼Œåˆ™æœ€ç»ˆçš„å±žæ€§ä¼šæ ¹æ®ä¸‹è¿°ä¼˜å…ˆçº§å–å€¼ï¼š
>
> ç”¨æˆ·è‡ªå®šä¹‰äº‹ä»¶å±žæ€§ > åŠ¨æ€å…¬å…±å±žæ€§ > äº‹ä»¶å…¬å…±å±žæ€§

æ‚¨å¯ä»¥è°ƒç”¨ `setSuperProperties`æ¥è®¾ç½®å…¬å…±äº‹ä»¶å±žæ€§ï¼Œå…¬å…±äº‹ä»¶å±žæ€§çš„æ ¼å¼è¦æ±‚ä¸Žäº‹ä»¶å±žæ€§ä¸€è‡´ã€‚åœ¨è®¾ç½®æ—¶åªèƒ½ä¼ å…¥å¸¸é‡ï¼Œé€‚åˆè®¾ç½®å˜åŒ–ä¸é¢‘ç¹çš„å±žæ€§ã€‚

> æ ¹æ®å±žæ€§ä¼˜å…ˆçº§ï¼Œè‡ªå®šä¹‰å±žæ€§ä¼˜å…ˆçº§é«˜äºŽäº‹ä»¶å…¬å…±å±žæ€§ï¼Œå› æ­¤äº‹ä»¶å…¬å…±å±žæ€§ä¹Ÿå¯ä»¥ä½œä¸ºæŸä¸ªå±žæ€§çš„ç¼ºçœå€¼ï¼Œåœ¨éœ€è¦ä¿®æ”¹çš„äº‹ä»¶ä¸­è®¾ç½®åŒå Key è¦†ç›–ç¼ºçœå€¼ã€‚

```js
//è®¾ç½®å…¬å…±äº‹ä»¶å±žæ€§
ge.setSuperProperties({ channel: "æ¸ é“" });

//ä½¿ç”¨trackä¸Šä¼ äº‹ä»¶ï¼Œæ­¤æ—¶äº‹ä»¶ä¸­ä¼šå¸¦æœ‰å…¬å…±äº‹ä»¶å±žæ€§
ge.track(
  "Purchase", //è¿½è¸ªäº‹ä»¶çš„åç§°
  {
    Item: "å•†å“A",
    ItemNum: 1,
    Cost: 100,
  } //éœ€è¦ä¸Šä¼ çš„äº‹ä»¶å±žæ€§
);

/* ç­‰ä»·äºŽåœ¨äº‹ä»¶ä¸­åŠ å…¥è¿™äº›å…¬å…±å±žæ€§
ge.track(
    'Purchase', //è¿½è¸ªäº‹ä»¶çš„åç§°
    {
        Item:'å•†å“A',
        ItemNum:1,
        Cost:100,
        channel:'æ¸ é“' //ç›¸å½“äºŽåœ¨äº‹ä»¶ä¸­åŠ å…¥è¿™ä¸ªå±žæ€§
    } 
);
*/
```

å¦‚æžœå¤šæ¬¡è°ƒç”¨ `setSuperProperties` è®¾ç½®å…¬å…±äº‹ä»¶å±žæ€§ï¼Œåˆ™åŒåå­—æ®µåŽé¢çš„è°ƒç”¨ä¼šè¦†ç›–ä¹‹å‰çš„ï¼Œä¸åŒåå­—æ®µã€‚

å¦‚æžœæ‚¨éœ€è¦åˆ é™¤æŸä¸ªå…¬å…±äº‹ä»¶å±žæ€§ï¼Œå¯ä»¥è°ƒç”¨ `unsetSuperProperty()` æ¸…é™¤å…¶ä¸­ä¸€ä¸ªå…¬å…±äº‹ä»¶å±žæ€§ï¼›å¦‚æžœæ‚¨æƒ³è¦æ¸…ç©ºæ‰€æœ‰å…¬å…±äº‹ä»¶å±žæ€§ï¼Œåˆ™å¯ä»¥è°ƒç”¨ `clearSuperProperties()`;å¦‚æžœæ‚¨æƒ³è¦èŽ·å–æ‰€æœ‰å…¬å…±äº‹ä»¶å±žæ€§ï¼Œå¯ä»¥è°ƒç”¨ `getSuperProperties`;

```javascript
// æ¸…é™¤å±žæ€§åä¸º CHANNEL çš„å…¬å…±å±žæ€§
ge.unsetSuperProperty("CHANNEL");

//æ¸…é™¤å…¬å…±äº‹ä»¶å±žæ€§
ge.clearSuperProperties();

//èŽ·å–é™æ€å…¬å…±äº‹ä»¶å±žæ€§
ge.getSuperProperties();
```

## ä¸‰ã€å‘é€äº‹ä»¶

æ‚¨å¯ä»¥ç›´æŽ¥è°ƒç”¨ `track`ä¸Šä¼ è‡ªå®šä¹‰äº‹ä»¶ï¼Œå»ºè®®æ‚¨æ ¹æ®å…ˆå‰æ¢³ç†çš„æ–‡æ¡£æ¥è®¾ç½®äº‹ä»¶çš„å±žæ€§ä»¥åŠå‘é€ä¿¡æ¯çš„æ¡ä»¶ï¼Œæ­¤å¤„ä»¥è´­ä¹°å•†å“ä¸ºèŒƒä¾‹ï¼š

```javascript
ge.track(
  "$purchase", //è¿½è¸ªäº‹ä»¶çš„åç§°
  {
    Item: "å•†å“A",
    ItemNum: 1,
    Cost: 100,
    Elements: ["apple", "ball", "cat"],
  } //éœ€è¦ä¸Šä¼ çš„äº‹ä»¶å±žæ€§
);
```

- `track` æŽ¥å£å…±æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºäº‹ä»¶çš„åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºäº‹ä»¶çš„å±žæ€§
- äº‹ä»¶çš„åç§°æ˜¯å­—ç¬¦ä¸²ï¼Œåªèƒ½ä»¥å­—æ¯å¼€å¤´ï¼Œå¯åŒ…å«æ•°å­—ï¼Œå­—æ¯å’Œä¸‹åˆ’çº¿â€œ\_â€ï¼Œé•¿åº¦æœ€å¤§ä¸º 50 ä¸ªå­—ç¬¦ï¼Œå¯¹å­—æ¯å¤§å°å†™ä¸æ•æ„Ÿã€‚
- äº‹ä»¶çš„å±žæ€§æ˜¯ JS å¯¹è±¡ï¼Œæ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªå±žæ€§ã€‚
- å…ƒç´ çš„ name å¯¹åº”å±žæ€§çš„åç§°ï¼Œè§„å®šåªèƒ½ä»¥å­—æ¯å¼€å¤´ï¼ŒåŒ…å«æ•°å­—ï¼Œå­—æ¯å’Œä¸‹åˆ’çº¿â€œ\_â€ï¼Œé•¿åº¦æœ€å¤§ä¸º 50 ä¸ªå­—ç¬¦ï¼Œå¯¹å­—æ¯å¤§å°å†™ä¸æ•æ„Ÿã€‚
- å…ƒç´ çš„ Value ä¸ºè¯¥å±žæ€§çš„å€¼ï¼Œæ”¯æŒ `String`ã€`Integer`ã€`Float`ã€`Boolean`ã€`Date`ã€`DateTime`å’Œ `Array`;`Array`ä¸­çš„å†…å®¹å¯ä»¥ä¸º `String`

å¼•åŠ›å¼•æ“ŽåŽå°å†…ç½®äº†ä¸€äº›é¢„ç½®äº‹ä»¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•åˆ†åˆ«ä¸ŠæŠ¥ï¼šæ³¨å†Œã€ç™»å½•ã€ç™»å‡ºäº‹ä»¶ã€‚

### 3.1 ç”¨æˆ·æ³¨å†Œäº‹ä»¶ä¸ŠæŠ¥

å½“ç”¨æˆ·æ³¨å†ŒæˆåŠŸæ—¶ï¼Œéœ€è¦è°ƒç”¨ `registerEvent` æ–¹æ³•è®°å½•ç”¨æˆ·æ³¨å†Œäº‹ä»¶

```javascript
ge.registerEvent();
```

### 3.2 ç”¨æˆ·ç™»å½•äº‹ä»¶ä¸ŠæŠ¥

å½“ç”¨æˆ·ç™»å½•æˆåŠŸæ—¶ï¼Œéœ€è¦è°ƒç”¨ `loginEvent` æ–¹æ³•è®°å½•ç”¨æˆ·ç™»å½•äº‹ä»¶

```javascript
ge.loginEvent();
```

### 3.3 ç”¨æˆ·æ³¨é”€ç™»å½•äº‹ä»¶ä¸ŠæŠ¥

å½“ç”¨æˆ·æ³¨é”€ç™»å½•æ—¶ï¼Œéœ€è¦è°ƒç”¨ `logoutEvent` æ–¹æ³•è®°å½•ç”¨æˆ·ç™»å‡ºäº‹ä»¶

```javascript
ge.logoutEvent();
```

### 3.4 è®¾ç½®äº‹ä»¶ä¸ŠæŠ¥æ—¶é—´

äº‹ä»¶è§¦å‘çš„æ—¶é—´é»˜è®¤å–æœ¬æœºæ—¶é—´ï¼Œä½†åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨è®¾ç½®äº‹ä»¶çš„æ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼š

```js
//ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå¯ä»¥è¾“å…¥Dateç±»åž‹çš„å‚æ•°ï¼Œæ›¿æ¢äº‹ä»¶è§¦å‘æ—¶é—´
ge.track("event", { parakey: "paravalue" }, new Date());

//å¦‚æžœæ²¡æœ‰propertieséœ€è¦ä¸Šä¼ ï¼Œè¯·ä¼ å…¥ä¸€ä¸ªç©ºå¯¹è±¡
ge.track("event", {}, new Date());
```

- ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºäº‹ä»¶è§¦å‘æ—¶é—´ï¼Œå¿…é¡»æ˜¯ Date ç±»åž‹ï¼Œå°†ä¼šæ›¿æ¢äº‹ä»¶è§¦å‘çš„æ—¶é—´ï¼Œå¦‚æžœä¸ä¼ è¯¥å‚æ•°ï¼Œåˆ™äº‹ä»¶è§¦å‘æ—¶é—´é»˜è®¤é€‰å–ç”¨æˆ·çš„æœ¬æœºæ—¶é—´

### 3.5 è®°å½•äº‹ä»¶æ—¶é•¿

æ‚¨å¯ä»¥è°ƒç”¨ `timeEvent`æ¥å¼€å§‹è®¡æ—¶ï¼Œé…ç½®æ‚¨æƒ³è¦è®¡æ—¶çš„äº‹ä»¶åç§°ï¼Œå½“æ‚¨ä¸Šä¼ è¯¥äº‹ä»¶æ—¶ï¼Œå°†ä¼šè‡ªåŠ¨åœ¨æ‚¨çš„äº‹ä»¶å±žæ€§ä¸­åŠ å…¥ `$event_duration`è¿™ä¸€å±žæ€§æ¥è¡¨ç¤ºè®°å½•çš„æ—¶é•¿ï¼Œå•ä½ä¸ºç§’ã€‚

```js
//ç”¨æˆ·è¿›å…¥å•†å“é¡µé¢ï¼Œå¼€å§‹è®¡æ—¶ï¼Œè®°å½•çš„äº‹ä»¶ä¸º"Enter_Shop"
ge.timeEvent("Enter_Shop");

//...

//ä¸Šä¼ äº‹ä»¶ï¼Œè®¡æ—¶ç»“æŸï¼Œ"Enter_Shop"è¿™ä¸€äº‹ä»¶ä¸­å°†ä¼šå¸¦æœ‰è¡¨ç¤ºäº‹ä»¶æ—¶é•¿çš„å±žæ€§$event_duration
ge.track("Enter_Shop", { product_id: "A1354" });
```

## å››ã€ç”¨æˆ·å±žæ€§

### 4.1 è®¾ç½®ç”¨æˆ·å±žæ€§ï¼ˆuserSetï¼‰

å¯¹äºŽä¸€èˆ¬çš„ç”¨æˆ·å±žæ€§ï¼Œæ‚¨å¯ä»¥è°ƒç”¨ `userSet`æ¥è¿›è¡Œè®¾ç½®ï¼Œä½¿ç”¨è¯¥æŽ¥å£ä¸Šä¼ çš„å±žæ€§å°†ä¼šè¦†ç›–åŽŸæœ‰çš„å±žæ€§å€¼ï¼Œå¦‚æžœä¹‹å‰ä¸å­˜åœ¨è¯¥ç”¨æˆ·å±žæ€§ï¼Œåˆ™ä¼šæ–°å»ºè¯¥ç”¨æˆ·å±žæ€§

```js
//è®¾ç½®ç”¨æˆ·å±žæ€§ï¼Œä¼šå‘˜ç­‰çº§
ge.userSet({ vip_level: "é’»çŸ³ä¼šå‘˜" });
```

> å±žæ€§æ ¼å¼è¦æ±‚ä¸Žäº‹ä»¶å±žæ€§ä¿æŒä¸€è‡´ã€‚

### 4.2 åˆå§‹åŒ–ç”¨æˆ·å±žæ€§ï¼ˆuserSetOnceï¼‰

å¦‚æžœæ‚¨è¦ä¸Šä¼ çš„ç”¨æˆ·å±žæ€§åªè¦è®¾ç½®ä¸€æ¬¡ï¼Œåˆ™å¯ä»¥è°ƒç”¨ `userSetOnce`æ¥è¿›è¡Œè®¾ç½®ï¼Œå½“è¯¥å±žæ€§ä¹‹å‰å·²ç»æœ‰å€¼çš„æ—¶å€™ï¼Œå°†ä¼šå¿½ç•¥è¿™æ¡ä¿¡æ¯ã€‚

```js
//ä»¥è®¾ç½®ç”¨æˆ·åä¸ºä¾‹ï¼Œå¦‚æžœç”¨æˆ·åå·²è®¾ç½®ï¼Œåˆ™å¿½ç•¥æœ¬æ¬¡è®¾ç½®ï¼Œå¦‚æžœä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®ä¸ºä¼ å…¥å€¼
ge.userSetOnce({ user_name: "TestUser" });
```

> å±žæ€§æ ¼å¼è¦æ±‚ä¸Žäº‹ä»¶å±žæ€§ä¿æŒä¸€è‡´ã€‚

### 4.3 ç´¯åŠ ç”¨æˆ·å±žæ€§ï¼ˆuserAddï¼‰

å½“æ‚¨è¦ä¸Šä¼ æ•°å€¼åž‹çš„å±žæ€§æ—¶ï¼Œæ‚¨å¯ä»¥è°ƒç”¨ `userAdd`æ¥å¯¹è¯¥å±žæ€§è¿›è¡Œç´¯åŠ æ“ä½œï¼Œå¦‚æžœè¯¥å±žæ€§è¿˜æœªè¢«è®¾ç½®ï¼Œåˆ™ä¼šèµ‹å€¼ 0 åŽå†è¿›è¡Œè®¡ç®—

```js
//ä»¥ä»˜è´¹ä¸ºä¾‹ï¼Œç”¨æˆ·æ¯æ¬¡ä»˜è´¹æ—¶è°ƒç”¨æ­¤æŽ¥å£ï¼Œåˆ™'total_revenue'å­—æ®µæ¯æ¬¡ä¼šåšç´¯åŠ ä»˜è´¹é‡‘é¢çš„å¤„ç†
ge.userAdd({ total_revenue: 50 });
```

> è®¾ç½®çš„å±žæ€§ key ä¸ºå­—ç¬¦ä¸²ï¼ŒValue åªå…è®¸ä¸ºæ•°å€¼ã€‚

### 4.4 é‡ç½®ç”¨æˆ·å±žæ€§ï¼ˆuserUnsetï¼‰

å½“æ‚¨è¦æ¸…ç©ºç”¨æˆ·çš„æŸä¸ªç”¨æˆ·å±žæ€§å€¼æ—¶ï¼Œæ‚¨å¯ä»¥è°ƒç”¨ `userUnset`æ¥å¯¹æŒ‡å®šå±žæ€§è¿›è¡Œæ¸…ç©ºæ“ä½œï¼Œå¦‚æžœè¯¥å±žæ€§è¿˜æœªåœ¨é›†ç¾¤ä¸­è¢«åˆ›å»ºï¼Œåˆ™ `userUnset`ä¸ä¼šåˆ›å»ºè¯¥å±žæ€§

```js
//æ¸…ç©ºå±žæ€§åä¸ºuserPropertyKeyçš„ç”¨æˆ·å±žæ€§å€¼è¯¥ç”¨æˆ·ï¼Œå³è®¾ç½®æˆNULL
ge.userUnset("userPropertyKey");
```

> userUnset: çš„ä¼ å…¥å€¼ä¸ºè¢«æ¸…ç©ºå±žæ€§çš„ Key å€¼ã€‚

### 4.5 åˆ é™¤ç”¨æˆ·ï¼ˆuserDelï¼‰

å¦‚æžœæ‚¨è¦åˆ é™¤æŸä¸ªç”¨æˆ·ï¼Œå¯ä»¥è°ƒç”¨ `userDel`å°†è¿™åç”¨æˆ·åˆ é™¤ï¼Œæ‚¨å°†æ— æ³•å†æŸ¥è¯¢è¯¥åç”¨æˆ·çš„ç”¨æˆ·å±žæ€§ï¼Œä½†è¯¥ç”¨æˆ·äº§ç”Ÿçš„äº‹ä»¶ä»ç„¶å¯ä»¥è¢«æŸ¥è¯¢åˆ°

```js
ge.userDel();
```

### 4.6 ä¸º Array ç±»åž‹çš„ç”¨æˆ·å±žæ€§è¿½åŠ å…ƒç´  (userAppend)

æ‚¨å¯ä»¥è°ƒç”¨ `userAppend` å¯¹ Array (List) ç±»åž‹çš„ç”¨æˆ·æ•°æ®è¿½åŠ å…ƒç´ ã€‚

```js
ge.userAppend({ Elements: [("a": 1), ("b": 2)] });
```

### 4.7 ä¸º Array ç±»åž‹çš„ç”¨æˆ·å±žæ€§åŽ»é‡è¿½åŠ å…ƒç´  (userUniqAppend)

`userUniqAppend` ç”¨æ¥å¯¹ Array (List) ç±»åž‹çš„ç”¨æˆ·æ•°æ®**åŽ»é‡**è¿½åŠ å…ƒç´ ã€‚

```js
ge.userUniqAppend({ Elements: [("a": 1), ("b": 2)] });
```

## äº”ã€è‡ªåŠ¨é‡‡é›†äº‹ä»¶

æˆ‘ä»¬æä¾›äº†è‡ªåŠ¨é‡‡é›†åŠŸèƒ½ï¼Œåªéœ€åœ¨åˆ›å»ºå®žä¾‹çš„ config ä¸­å¼€å¯æ‚¨éœ€è¦è‡ªåŠ¨é‡‡é›†çš„äº‹ä»¶ï¼ŒSDK å°†ä¼šè‡ªåŠ¨é‡‡é›†å°ç¨‹åºçš„ä¸€äº›è¡Œä¸ºï¼ŒçŽ°åœ¨ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§äº‹ä»¶æ”¯æŒè‡ªåŠ¨é‡‡é›†ï¼š

çŽ°åœ¨æ”¯æŒçš„è‡ªåŠ¨åŒ–æ”¶é›†æ•°æ®æœ‰ï¼š

1. å°ç¨‹åºåˆå§‹åŒ–ï¼Œç”¨æˆ·ä¸€æ¬¡ä½¿ç”¨åªä¼šè§¦å‘ä¸€æ¬¡
2. å°ç¨‹åºå¯åŠ¨ï¼ŒåŒ…æ‹¬å¯åŠ¨ä¸ŽåŽå°è°ƒå›žå‰å°
3. å°ç¨‹åºè°ƒå…¥åŽå°ï¼Œå¹¶è®°å½•æœ¬æ¬¡è®¿é—®ï¼ˆå¯åŠ¨è‡³è°ƒå…¥åŽå°ï¼‰çš„æ—¶é—´
4. å°ç¨‹åºé¡µé¢æ˜¾ç¤ºæˆ–åˆ‡å…¥å‰å°ï¼Œè‡ªåŠ¨è®°å½•é¡µé¢çš„è·¯å¾„ä»¥åŠå‰å‘è·¯å¾„
5. å°ç¨‹åºè¿›è¡Œè½¬å‘åˆ†äº«ï¼Œè‡ªåŠ¨è®°å½•è½¬å‘æ—¶çš„é¡µé¢

æŽ¥ä¸‹æ¥å°†ä¼šè¯¦ç»†ä»‹ç»æ¯ç§æ•°æ®çš„é‡‡é›†æ–¹æ³•ã€‚

### 5.1 å¼€å¯è‡ªåŠ¨é‡‡é›†äº‹ä»¶

åœ¨ config ä¸­ï¼Œå‚æ•° `autoTrack`ä¸­çš„å…ƒç´ è¡¨ç¤ºæ¯ä¸ªè‡ªåŠ¨é‡‡é›†äº‹ä»¶çš„å¼€å…³ï¼Œè®¾ç½®ä¸º `true`ä¸ºå¼€å¯è‡ªåŠ¨é‡‡é›†ï¼š

```js
var config = {
  autoTrack: {
    appLaunch: true, // è‡ªåŠ¨é‡‡é›† $MPLaunch
    appShow: true, // è‡ªåŠ¨é‡‡é›† $MPShow
    appHide: true, // è‡ªåŠ¨é‡‡é›† $MPhide
    pageShow: true, // è‡ªåŠ¨é‡‡é›† $MPViewScreen
    pageShare: true, // è‡ªåŠ¨é‡‡é›† $MPShare
  },
};
```

- `appLaunch`ï¼šè‡ªåŠ¨é‡‡é›†å°ç¨‹åºåˆå§‹åŒ–
- `appShow`ï¼šè‡ªåŠ¨é‡‡é›†å°ç¨‹åºå¯åŠ¨ï¼Œæˆ–ä»ŽåŽå°è¿›å…¥å‰å°
- `appHide`ï¼šè‡ªåŠ¨é‡‡é›†å°ç¨‹åºä»Žå‰å°è¿›å…¥åŽå°
- `pageShow`ï¼šè‡ªåŠ¨é‡‡é›†å°ç¨‹åºé¡µé¢æ˜¾ç¤ºæˆ–åˆ‡å…¥å‰å°
- `pageShare`ï¼šè‡ªåŠ¨é‡‡é›†å°ç¨‹åºè¿›è¡Œè½¬å‘åˆ†äº«

ä¸åŒå¹³å°ç”±äºŽè¿è¡ŒçŽ¯å¢ƒä»¥åŠç»“æž„åŽŸå› ï¼Œæ”¯æŒä¸åŒçš„è‡ªåŠ¨é‡‡é›†äº‹ä»¶ï¼Œæ”¯æŒåˆ—è¡¨å¦‚ä¸‹ï¼š
| å¹³å° | appLaunch | appShow | appHide|pageShow|pageShare|
| ------------ | ---- | ------------------------ |---|---|---|
| å°ç¨‹åº | âœ… | âœ… |âœ… |âœ… |âœ… |
| å°æ¸¸æˆ | | âœ… |âœ… | | |

### 5.2 è‡ªåŠ¨é‡‡é›†äº‹ä»¶è¯¦è§£

#### 5.2.1 å°ç¨‹åºåˆå§‹åŒ–

å°ç¨‹åºåˆå§‹åŒ–å°†ä¼šåœ¨å°ç¨‹åºè¢«é¦–æ¬¡æ‰“å¼€æ—¶ï¼Œæˆ–ç”¨æˆ·æ€æ­»è¿›ç¨‹å†é‡æ–°å¼€å¯æ—¶è§¦å‘ï¼Œåœ¨è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…åªä¼šè§¦å‘ä¸€æ¬¡ï¼Œè¯¦ç»†çš„äº‹ä»¶ä»‹ç»å¦‚ä¸‹ï¼š

- äº‹ä»¶åï¼š$MPLaunch
- è‡ªåŠ¨é‡‡é›†å±žæ€§ï¼š `$scene`ï¼Œåœºæ™¯å€¼ï¼Œå–è‡ªå¾®ä¿¡æä¾›çš„åœºæ™¯å€¼

é€šè¿‡å°ç¨‹åºåˆå§‹åŒ–äº‹ä»¶ï¼Œæ‚¨å¯ä»¥è®¡ç®—æ¯å¤©çš„ç”¨æˆ·ä½¿ç”¨æ¬¡æ•°ã€äººå‡ä½¿ç”¨æ¬¡æ•°ï¼ŒåŒ…æ‹¬ä»¥åœºæ™¯å€¼åšåˆ†ç»„ï¼ŒæŸ¥çœ‹ä¸åŒåœºæ™¯å€¼çš„ç”¨æˆ·çš„ä½¿ç”¨æƒ…å†µã€‚

#### 5.2.2 å°ç¨‹åºå¯åŠ¨

å°ç¨‹åºå¯åŠ¨å°†ä¼šåœ¨å°ç¨‹åºè¢«å¯åŠ¨ã€æˆ–å°ç¨‹åºè¢«ä»ŽåŽå°è°ƒå›žå‰å°æ—¶è§¦å‘ï¼Œè¯¦ç»†çš„äº‹ä»¶ä»‹ç»å¦‚ä¸‹ï¼š

- äº‹ä»¶åï¼š$MPShow
- è‡ªåŠ¨é‡‡é›†å±žæ€§ï¼š
- `$scene`ï¼Œåœºæ™¯å€¼ï¼Œå–è‡ªå¾®ä¿¡æä¾›çš„åœºæ™¯å€¼
- `$url_path`ï¼Œé¡µé¢è·¯å¾„ï¼Œå°ç¨‹åºå¯åŠ¨è¢«å±•ç¤ºé¡µé¢çš„è·¯å¾„
- `$url_query`ï¼Œé¡µé¢å‚æ•°

å°ç¨‹åºå¯åŠ¨ç”±äºŽä¼šå—åˆ°è°ƒå‡ºå‰åŽå°çš„å½±å“ï¼ˆæ¡æ•°è¾ƒå¤šï¼‰ï¼Œå› æ­¤ä¸å¤ªé€‚åˆç›´æŽ¥è¿›è¡Œåˆ†æžï¼Œä½†æ˜¯å¯ä»¥åœ¨è¡Œä¸ºè·¯å¾„ä¸­æ ‡è¯†ç”¨æˆ·çš„ä¸€æ¬¡ä½¿ç”¨ï¼Œå¯ä»¥ä½œä¸ºç”¨æˆ·è¡Œä¸ºè·¯å¾„çš„åˆå§‹è¡Œä¸º

#### 5.2.3 å°ç¨‹åºéšè—

å°ç¨‹åºéšè—å°†ä¼šåœ¨å°ç¨‹åºè¢«è°ƒå…¥åŽå°æ—¶è§¦å‘ï¼Œå¹¶è®°å½•æœ¬æ¬¡ä½¿ç”¨çš„æ—¶é•¿ï¼Œè¯¦ç»†çš„äº‹ä»¶ä»‹ç»å¦‚ä¸‹ï¼š

- äº‹ä»¶åï¼š$MPHide
- è‡ªåŠ¨é‡‡é›†å±žæ€§ï¼š
  - `$scene`ï¼Œåœºæ™¯å€¼ï¼Œå–è‡ªå¾®ä¿¡æä¾›çš„åœºæ™¯å€¼
  - `$event_duration`ï¼Œæ•°å€¼åž‹ï¼Œè¡¨ç¤ºæœ¬æ¬¡å¯åŠ¨ï¼ˆ$MPShowï¼‰åˆ°éšè—çš„æŒç»­æ—¶é•¿

å°ç¨‹åºéšè—äº‹ä»¶ä¼šè®°å½•ä½¿ç”¨æ—¶é•¿ï¼ˆå•ä½ä¸ºç§’ï¼‰ï¼Œå› æ­¤å¯ä»¥ç›´æŽ¥è®¡ç®—ç”¨æˆ·ä½¿ç”¨æ€»æ—¶é•¿ä»¥åŠäººå‡æ—¶é•¿ï¼Œä¹Ÿå¯ä»¥é™¤ä»¥åˆå§‹åŒ–æ¬¡æ•°è®¡ç®—å•æ¬¡ä½¿ç”¨æ—¶é•¿ã€‚

#### 5.2.4 å°ç¨‹åºé¡µé¢æµè§ˆ

å°ç¨‹åºé¡µé¢æµè§ˆå°†ä¼šåœ¨å°ç¨‹åºçš„é¡µé¢è¢«æ‰“å¼€æ—¶ï¼Œæˆ–å°ç¨‹åºä»ŽåŽå°è°ƒå›žå‰å°çš„é¡µé¢å±•ç¤ºæ—¶è§¦å‘ï¼Œä¼šè®°å½•é¡µé¢çš„è·¯å¾„ä»¥åŠè®¿é—®çš„å‰å‘è·¯å¾„ï¼Œè¯¦ç»†çš„äº‹ä»¶ä»‹ç»å¦‚ä¸‹ï¼š

- äº‹ä»¶åï¼š$MPViewScreen
- è‡ªåŠ¨é‡‡é›†å±žæ€§ï¼š
  - `#scene`ï¼Œåœºæ™¯å€¼ï¼Œå–è‡ªå¾®ä¿¡æä¾›çš„åœºæ™¯å€¼
  - `#url_path`ï¼Œé¡µé¢è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¢«å±•ç¤ºé¡µé¢çš„è·¯å¾„
  - `$url_query`ï¼Œé¡µé¢å‚æ•°

é€šè¿‡å°ç¨‹åºé¡µé¢æµè§ˆäº‹ä»¶ï¼Œæ‚¨å¯ä»¥è®¡ç®—æ¯ä¸ªé¡µé¢çš„ pvã€uvï¼Œä»¥åŠç”¨æˆ·è®¿é—®å°ç¨‹åºçš„ä½¿ç”¨è·¯å¾„ã€‚

#### 5.2.5 å°ç¨‹åºé¡µé¢è½¬å‘åˆ†äº«

å°ç¨‹åºé¡µé¢è½¬å‘åˆ†äº«å°†ä¼šåœ¨è½¬å‘æŒ‰é’®è¢«ç‚¹å‡»æ—¶è§¦å‘ï¼ˆåŒ…æ‹¬å³ä¸Šè§’å¯¼èˆªæ çš„è½¬å‘æŒ‰é’®ï¼Œä»¥åŠé¡µé¢ä¸­çš„è½¬å‘æŒ‰é’®ï¼‰ï¼Œè¯¦ç»†çš„äº‹ä»¶ä»‹ç»å¦‚ä¸‹ï¼š

- äº‹ä»¶åï¼š$MPShare
- è‡ªåŠ¨é‡‡é›†å±žæ€§ï¼š
  - `$scene`ï¼Œåœºæ™¯å€¼ï¼Œå–è‡ªå¾®ä¿¡æä¾›çš„åœºæ™¯å€¼
  - `$url_path`ï¼Œé¡µé¢è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è½¬å‘æ—¶æ‰€åœ¨çš„é¡µé¢è·¯å¾„
  - `$share_method`ï¼Œåˆ†äº«é€”å¾„
  - `$share_depth`ï¼Œé¡µé¢å±‚çº§

å°ç¨‹åºé¡µé¢è½¬å‘åˆ†äº«äº‹ä»¶ï¼Œé€‚åˆå¯¹é¡µé¢çš„åˆ†äº«çŽ‡è¿›è¡Œåˆ†æžï¼Œå¯ä»¥å¸®åŠ©æ‚¨ä¼˜åŒ–é¡µé¢è½¬å‘ã€‚

## å…­ã€å…¶ä»–åŠŸèƒ½

### 6.1 onComplete å›žè°ƒå‡½æ•°

å¯¹äºŽ track, userSet, userSetOnce, userAdd, userDel, userAppend, userUniqAppend ç­‰æŽ¥å£ï¼Œæ”¯æŒä¼ å…¥ onComplete å›žè°ƒ. å¯ä»¥ç›´æŽ¥åœ¨åŽŸå‚æ•°åˆ—è¡¨åŽä¼ å…¥ onComplete,

ä¹Ÿå¯ä»¥ä½¿ç”¨å‚æ•°å¯¹è±¡çš„æ–¹å¼. å¦‚æžœä½¿ç”¨å‚æ•°å¯¹è±¡ï¼Œå‚æ•°å¯¹è±¡ä¸­å¿…é¡»åŒ…å« onComplete, å¦åˆ™ä¼šå‡ºçŽ°å‚æ•°é”™è¯¯.

ä»¥ä¸Šä¼ äº‹ä»¶ä¸ºä¾‹ï¼š

```js
// ä»¥å‚æ•°åˆ—è¡¨çš„å½¢å¼ä¼ å…¥å›žè°ƒ
ge.track("test", { testkey: 123 }, new Date(), (res) => {
  console.log(res);
});

// ä»¥å‚æ•°å¯¹è±¡çš„å½¢å¼ä¼ å…¥å›žè°ƒ
ge.track({
  eventName: "test", // å¿…å¡«
  properties: { testkey: 123 }, // å¯é€‰
  time: new Date(), // å¯é€‰
  onComplete: (res) => {
    console.log(res);
  }, // å¿…å¡«
});
```

onComplete çš„å‚æ•° res ä¸º object ç±»åž‹ï¼Œæœ‰ä¸¤ä¸ªå±žæ€§ code å’Œ msg.

res.code ä¸º int ç±»åž‹ï¼Œå®šä¹‰å¦‚ä¸‹:

- 0: æˆåŠŸ
- -3: ç½‘ç»œæˆ–æœåŠ¡ç«¯å¼‚å¸¸
- 2001 åº”ç”¨æœªæŽˆæƒæˆ–å·²è¿‡æœŸ
- 2000 æƒé™ä¸è¶³ è¯¥ç”¨æˆ·å°šæœªæ³¨å†Œ
- 1004 å‚æ•°é”™è¯¯ ä¸€èˆ¬æ˜¯å‚æ•°ç±»åž‹é”™è¯¯ï¼Œæˆ–è€…ç¼ºå¤±å‚æ•°
- 1001 æ•°æ®é”™è¯¯ json è§£æžé”™è¯¯

res.msg æ˜¯å¯¹ res.code çš„æ–‡å­—è¯´æ˜Žã€‚

### 6.2 å¼€å¯ Debug æ¨¡å¼

Debug æ¨¡å¼å¯èƒ½ä¼šå½±å“æ•°æ®é‡‡é›†è´¨é‡å’Œ App çš„ç¨³å®šæ€§ï¼Œåªç”¨äºŽé›†æˆé˜¶æ®µæ•°æ®éªŒè¯ï¼Œä¸è¦åœ¨çº¿ä¸ŠçŽ¯å¢ƒä½¿ç”¨ã€‚

å½“å‰ SDK å®žä¾‹æ”¯æŒä¸‰ç§è¿è¡Œæ¨¡å¼ï¼š

- "none": ä¸å¼€å¯ Debug
- "debug": å¼€å¯ Debug æ¨¡å¼ï¼Œå¹¶å…¥åº“

å¯ä»¥åœ¨ SDK åˆå§‹åŒ–çš„æ—¶å€™é…ç½® Debug æ¨¡å¼ï¼š

```js
var config = {
  debugMode: "debug",
};
var ge = new GE(config);
```

### 6.3 æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯

æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨ `queryUser` æ–¹æ³•èŽ·çŸ¥å½“å‰ç”¨æˆ·çš„ä¹°é‡ä¿¡æ¯ï¼Œå…·ä½“å‚æ•°å¦‚ä¸‹ã€‚

```javascript
/**
 * æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒåŒ…æ‹¬
 * 1. client_id       ç”¨æˆ·ID
 * 2. channel         ç”¨æˆ·æ¸ é“
 * 3. click_company   ç”¨æˆ·ä¹°é‡æ¥æºï¼Œæžšä¸¾å€¼ ä¸ºï¼štencentã€bytedanceã€kuaishou  ä¸ºç©ºåˆ™ä¸ºè‡ªç„¶é‡ç”¨æˆ·
 * 4. aid             å¹¿å‘Šè®¡åˆ’ID
 * 5. cid             å¹¿å‘Šåˆ›æ„ID
 * 6. advertiser_id   å¹¿å‘Šè´¦æˆ·ID
 * 7. bytedance_v2    å¤´æ¡ä½“éªŒç‰ˆæ•°æ®ï¼ˆç”¨æˆ·å¦‚æžœä¸ºå¤´æ¡ä½“éªŒç‰ˆæŠ•æ”¾èŽ·å–çš„ï¼Œbytedance_v2æ‰æœ‰å€¼ï¼‰
 *    1. project_id   é¡¹ç›®ID
 *    2. promotion_id å¹¿å‘ŠID
 *    3. mid1         å›¾ç‰‡ID
 *    4. mid2         æ ‡é¢˜ID
 *    5. mid3         è§†é¢‘ID
 *    6. mid4         è¯•å®ŒID
 *    7. mid5         è½åœ°é¡µID
 *
 * è¿”å›žç¤ºä¾‹å¦‚ä¸‹ï¼Œå…·ä½“å¯ä»¥æ‰“å°è¿”å›žçš„dataæŸ¥çœ‹
 * "user_list": [
      {
        "create_time": "2022-09-09 14:50:04",
        "client_id": "Bn2RhTcU",
        "advertiser_id": "12948974294275",
        "channel": "wechat_mini_program",
        "click_company": "gdt",
        "aid": "65802182823",
        "cid": "65580218538",
 	      "bytedance_v2": {
          "project_id":"924563792",
          "promotion_id":"93795753",
          "mid1":"3256634642",
          "mid2":"2353252367",
          "mid3":"3245235236",
          "mid4":"6346347623",
          "mid5":"7345232424"
        }
      },
    ]
 */
ge.queryUser().then((data) => {
  console.log(data);
});
```
